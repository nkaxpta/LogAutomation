## Installation

2 行目 `$LOGFILE_PATH = "${ログ保存フォルダ}"` の""内に作業ログを保存したいフォルダパスに変更し保存する

## Usage

1. 作業ログをクリップボードにコピーした状態で.ps1 ファイルを開く
2. 保存したい名前を入力し Enter
3. 2.が終了後に勝手に保存されます（デフォルトでの保存名は yyyy-mm-dd <2.で入力した名前>）

## Note

1. .ps1 ファイルは仕様上文字コードが **Shift-JIS** でないと文字化けを起こし、正常に動きません。必ず Shift-JIS にしてから保存してください。
2. 未検証ですが、同じドライブ内に.ps1 ファイルを置かないと正しく名前を変えて保存してくれないかもしれないです。修正出来たら直します。

## Recovery

ファイル名に使用できない文字が含まれていると、ファイルは保存されません。 ※.bat ファイルから行った仕様変更です。

## bat バージョンとの相違点

1. 一度適当な名前で一度保存するという仕様を一度変数に格納するように変更  
   これにより処理が早くなる他、誤って動作させた場合に閉じても指定のフォルダにゴミが残らない様になりました。
2. 指定フォルダを開いている際に再度実行すると 2 つ目の同フォルダが開かれてしまう仕様を修正  
   これにより何度も閉じる必要がなくなりました。かといって保存された際には再度アクティブ化されるので「どこに行った？」のようなことは起こりにくくなっています。
3. bat コードの可読性の低さを改善  
   bat コードにはどうしても可読性の低さが残り、何の処理をしているのか見えにくいのがネックだったのですが、PowerShell Script は比較的読みやすい為可読性の向上に成功しました。

## タスクバーなどに登録して一発で起動させる

.ps1 ファイルは Windows の仕様上、このままではタスクバーやスタートメニューにピン止めしても実行することができません。
（クリックしてもメモ帳が開くだけ）  
そのため、以下の方法で 1 クリックで動作するようにします。

1. .ps1 ファイルのショートカットを作成
2. 作成したショートカットのプロパティのリンク先の先頭に `powershell -NoProfile -ExecutionPolicy RemoteSigned -File ` を追記し、適用  
   ※「-File」の後に半角スペースあり
3. ショートカットをタスクバーなどにピン止め

これでショートカットをクリックするだけで.ps1 ファイルが立ち上がりスクリプトが実行されるようになります。
